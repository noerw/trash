<!-- created by Albert Hamzin -->

<!DOCTYPE html>
<html>
<head>
  <title>Hello Handlebars</title>

  <!-- You can download Handlebars at http:// handlebarsjs.com/ and save it as handlebars-v4.0.2.js on your site. Then make it available by adding the following line. -->
  <script src="./js/handlebars-v4.0.12.js"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.8.9/jquery.csv.min.js"></script>


</head>

<body>
<!-- The information will be placed in this div -->
<div id="rdfText"></div>

<script type="text/javascript">

  $(document).ready(function () {
    $.ajax({
      type: "GET",
      url: "./euWaste.csv",
      dataType: "text",
      success: function (data) {
        processData(data);
      }
    });
  });

  function processData(allText) {
    let allTextLines = allText.split(/\r\n|\n/);    // allTextLines rows
    let headers = allTextLines[0].split(',');       // allTextLines[0] or headers ==> header row
    let units = [];
    let hazard = [];
    let wst_oper = [];
    let waste = [];
    let geo_time = [];
    let twenty16 = [];
    let twenty14 = [];
    let twenty12 = [];
    let twenty10 = [];
    let twenty08 = [];
    let twenty06 = [];
    let twenty04 = [];

    for (let i = 1; i < allTextLines.length; i++) {
      let dataCol = allTextLines[i].split(',');
      if (dataCol.length == headers.length) {       // Note only columns with the same length as the header columns.

        let col1 = [];
        let col2 = [];
        let col3 = [];
        let col4 = [];
        let col5 = [];
        let col6 = [];
        let col7 = [];
        let col8 = [];
        let col9 = [];
        let col10 = [];
        let col11 = [];
        let col12 = [];
        //  for (let j = 0; j < headers.length; j++) {
        col1.push(dataCol[0]);
        col2.push(dataCol[1]);
        col3.push(dataCol[2]);
        col4.push(dataCol[3]);
        col5.push(dataCol[4]);
        col6.push(dataCol[5]);
        col7.push(dataCol[6]);
        col8.push(dataCol[7]);
        col9.push(dataCol[8]);
        col10.push(dataCol[9]);
        col11.push(dataCol[10]);
        col12.push(dataCol[11]);
        //  }
        units.push(col1);
        hazard.push(col2);
        wst_oper.push(col3);
        waste.push(col4);
        geo_time.push(col5);
        twenty16.push(col6);
        twenty14.push(col7);
        twenty12.push(col8);
        twenty10.push(col9);
        twenty08.push(col10);
        twenty06.push(col11);
        twenty04.push(col12);

      }


    }
    //document.getElementById('rdfText').innerHTML += units[0];
    //console.log(hazard);

    // Structure how I want the data to dynamically be
    // placed by defining the keys in between {{}}


    //let myInfo = "<p>My name is {{name}} and I live at {{street}} in {{city}}, {{state}}</p>";

    let myInfo = "<p>ex:{{observation_id}} a qb:Observation,\n  <br>" +
      "qb:dataset ex:dataset,\n <br>" +
      "ex:refArea \"{{nutsregion}}\",\n <br>" +
      "sdmx-concept:refPeriod \"{{year}}\",\n <br>" +
      "iso37120:16.3 \"{{recycling}}\",\n <br>" +
      "iso37120:16.2 \"{{waste_generation}}\".</p><br> <br>";

    // Generate a JS function that will create the output
    let template = Handlebars.compile(myInfo);

    // template receives the key / value pairs and puts
    // them in place
    //let data = template({name: "Albert", street: "heisenberstr", city: "m√ºnster", state: "NRW"});
    let data = template({
      observation_id: "Albert", nutsregion: geo_time[1],
      year: "2008", recycling: "-", waste_generation: twenty08[3]
    });

    // Update the div with the completed output
    document.getElementById('rdfText').innerHTML += data;

  }

</script>

</body>
</html>


























